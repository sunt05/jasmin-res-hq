# Session: 2025-12-31 (LOCAL)

**Issue**: [[PER-393]] / [[PER-394]]

## Completed
- [x] Fixed longitude conversion bug in `extract_era5_cities.py`
- [x] Added `lon_to_360()` function (converts -180/180 to ERA5's 0-360)
- [x] Pushed to GitHub

## For JASMIN Session

Pull and test the updated extraction script:

```bash
cd /gws/nopw/j04/landsurf_rdg/sunt05/jasmin-res-hq
git pull origin main
```

Run single city test to verify fix:

```bash
uv run python 20251231-hw-er-pilot/scripts/extract_era5_cities.py \
    --city-id 47 --years 2020 --output-dir outputs/era5
```

Expected output: Freetown extraction with valid data (~25°C mean temp).

If successful, run subset extraction (first 10 cities or by region):

```bash
# Full extraction takes >1 hour - consider batching
uv run python 20251231-hw-er-pilot/scripts/extract_era5_cities.py \
    --city-list 20251231-hw-er-pilot/data/cities.csv \
    --years 2020-2023 --output-dir outputs/era5
```

## Notes
- Script processes cities sequentially - 882 cities × 4 years will exceed 1-hour limit
- Consider filtering cities.csv by region for batched runs
- Output files: `outputs/era5/era5_{city_id}_{city_name}.nc`

## Files Changed
- `20251231-hw-er-pilot/scripts/extract_era5_cities.py` - Added longitude conversion
